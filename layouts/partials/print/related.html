{{- $page := . -}}
{{- $related := "" -}}
{{- with .Params.related -}}
    {{- range . -}}
      {{/* TODO: this is just a stupid trick to get the page */}}
      {{- $relatedPath := printf "/post/%s" (string .) -}}
      {{- $nr := string . -}}
      {{- with partial "content/hanger.html" $relatedPath -}}
        {{- $title := .Title -}}
        {{- if eq $title "" -}}
          {{- $title = .Description -}}
        {{- end -}}
        {{- $link := printf "#_%s" (replace .RelPermalink "/" "-") -}}
        {{- $related = printf `%s<li class="related-list-item"><a href="%s" title="%s">%s<span class="hanger-number"> (#%s)</span></a></li>` $related  $link ($title | htmlEscape) $title $nr -}}
      {{- else -}}
        {{- warnf "[content/related.html] Unable to get related %s for %s, ignoring, maybe post is in the future" $relatedPath $page.RelPermalink -}}
      {{- end -}}
    {{- end -}}
{{- end -}}
{{- if ne $related "" -}}
  <div class="additional-header">{{ i18n "related" }}</div>
  <ul class="related-list">
    {{- $related | safeHTML -}}
  </ul>
{{- end -}}
